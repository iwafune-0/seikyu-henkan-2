# 配布前動作確認チェックリスト

**作成日**: 2026-01-28
**対象**: Phase 12 Electron化前の確認、および配布時の確認

---

## 1. 環境設定確認

### backend/.env 設定

| 項目 | 設定値 | 確認 |
|------|--------|------|
| SUPABASE_URL | 本番Supabase URL | [ ] |
| SUPABASE_SERVICE_ROLE_KEY | 本番Service Role Key | [ ] |
| PDF_ENGINE | `excel`（Windows配布の場合） | [ ] |
| APP_MODE | `electron`（Electron配布の場合） | [ ] |
| NODE_ENV | `production` | [ ] |
| PORT | `3001` | [ ] |
| FRONTEND_URL | `http://localhost:5174` | [ ] |

### frontend/.env 設定

| 項目 | 設定値 | 確認 |
|------|--------|------|
| VITE_SUPABASE_URL | 本番Supabase URL | [ ] |
| VITE_SUPABASE_ANON_KEY | 本番Anon Key | [ ] |

---

## 2. 配布先PC要件確認

| 要件 | 詳細 | 確認 |
|------|------|------|
| OS | Windows 10/11 | [ ] |
| Excel | Microsoft Excel 2016以降 | [ ] |
| ネットワーク | Supabaseへのアクセス可能 | [ ] |

---

## 3. 機能別動作確認

### 3.1 認証機能（P-001）

| テスト項目 | 手順 | 期待結果 | 確認 |
|-----------|------|---------|------|
| ログイン | メールアドレス・パスワード入力 | ログイン成功、P-002へ遷移 | [ ] |
| ログアウト | サイドバーのログアウトボタン | ログアウト、ログインページへ | [ ] |
| セッション維持 | ブラウザ再起動後アクセス | ログイン状態維持 | [ ] |

### 3.2 PDF処理（P-002）

| テスト項目 | 手順 | 期待結果 | 確認 |
|-----------|------|---------|------|
| ネクストビッツ処理 | 4つのPDFアップロード→処理実行 | Excel・PDF生成成功 | [ ] |
| オフビート処理 | 4つのPDFアップロード→処理実行 | Excel・PDF生成成功 | [ ] |
| テンプレート取得 | 2回目以降の処理 | DBから自動取得 | [ ] |
| ダウンロード | 処理完了後のダウンロードボタン | 全ファイルダウンロード可能 | [ ] |

### 3.3 処理履歴（P-003）

| テスト項目 | 手順 | 期待結果 | 確認 |
|-----------|------|---------|------|
| 一覧表示 | P-003アクセス | 処理履歴一覧表示 | [ ] |
| フィルタ | 取引先・期間で絞り込み | 絞り込み結果表示 | [ ] |
| ダウンロード | 各ファイルのダウンロード | ダウンロード成功 | [ ] |

### 3.4 ユーザー管理（P-004）- 管理者のみ

| テスト項目 | 手順 | 期待結果 | 確認 |
|-----------|------|---------|------|
| ユーザー一覧 | P-004アクセス | ユーザー一覧表示 | [ ] |
| ユーザー追加（APP_MODE=electron） | 新規追加ボタン→情報入力 | ユーザー追加成功 | [ ] |
| ロール変更 | ロール選択変更 | ロール変更成功 | [ ] |
| ユーザー削除 | 削除ボタン | 論理削除成功 | [ ] |

### 3.5 取引先設定（P-005）- 管理者のみ

| テスト項目 | 手順 | 期待結果 | 確認 |
|-----------|------|---------|------|
| 取引先一覧 | P-005アクセス | 取引先一覧表示 | [ ] |
| テンプレート更新 | Excelアップロード | テンプレート更新成功 | [ ] |
| 有効/無効切り替え | トグル操作 | 状態変更成功 | [ ] |

---

## 4. PDF出力品質確認

### PDF_ENGINE=excel の場合

| 確認項目 | 詳細 | 確認 |
|---------|------|------|
| 注文書PDF | 書式・レイアウト正常 | [ ] |
| 検収書PDF | 書式・レイアウト正常 | [ ] |
| 日本語表示 | 文字化けなし | [ ] |
| 印刷プレビュー | A4サイズ適切 | [ ] |

---

## 5. エラーハンドリング確認

| シナリオ | 操作 | 期待結果 | 確認 |
|---------|------|---------|------|
| 不正なPDF | 非対応PDFをアップロード | エラーメッセージ表示 | [ ] |
| ネットワーク切断 | オフライン状態で操作 | 適切なエラー表示 | [ ] |
| Excel未インストール | PDF生成実行 | エラーメッセージ表示 | [ ] |

---

## 6. セキュリティ確認

| 項目 | 確認内容 | 確認 |
|------|---------|------|
| 認証必須 | 未ログインでのアクセス不可 | [ ] |
| 権限分離 | 一般ユーザーはP-004/P-005アクセス不可 | [ ] |
| Service Role Key | .envファイルに含まれ、Gitにコミットされていない | [ ] |

---

## 7. 配布パッケージ確認（Phase 12完了後）

| 項目 | 確認内容 | 確認 |
|------|---------|------|
| インストーラー | 正常にインストール可能 | [ ] |
| 初回起動 | アプリが正常起動 | [ ] |
| アンインストール | 正常にアンインストール可能 | [ ] |
| アップデート | 上書きインストール可能 | [ ] |

---

## 確認記録

| 日付 | 確認者 | 環境 | 結果 | 備考 |
|------|--------|------|------|------|
| | | | | |

---

**補足**:
- E2Eテスト結果: 173/176 Pass（3項目スキップはSupabaseレート制限・RLS問題）
- 詳細なテスト結果は `docs/e2e-test-checklist.md` を参照
