# Phase 4 残作業まとめ

**作成日**: 2025-12-01
**最終更新**: 2025-12-01
**対象**: P-002 PDF処理実行ページ

---

## 完了した作業（今回のセッション）

- [x] スロット管理機能（4種類のPDFスロット、OK/未設定表示）
- [x] PDF種別判別（見積/請求/請書/納品キーワード）
- [x] 個別スロットへのアップロード時の種別検証
- [x] ドラッグ&ドロップUI（オーバーレイ表示、白85%透明度）
- [x] エラー表示ルール（Snackbar/ダイアログ使い分け）
- [x] 要件定義書の更新（v1.8）
- [x] 命名規則の要件定義書追記
- [x] 取引先判別ロジックの更新（命名規則ベース: TRR- / offbeat-to-terra）
- [x] 取引先混在検知の実装（一括アップロード時・個別アップロード時）
- [x] エラー表示の統一（ダイアログ表示、既存ファイル維持）
- [x] UI改善（アイコン削除、取引先名を「株式会社〇〇」形式に統一）

---

## 次回開始時の作業

### 1. P-002の動作確認・テスト（優先度: 高）

**概要**:
P-002の実装が一通り完了したため、以下のシナリオで動作確認を行う

**テストシナリオ**:
1. ネクストビッツのファイル4つをアップロード → 処理実行 → ダウンロード
2. オフビートワークスのファイル4つをアップロード → 初回Excel要求 → 処理実行
3. 異なる取引先のファイルを混在させてアップロード → エラー表示確認
4. 判別できないファイル名でアップロード → エラー表示確認
5. 個別スロットへのファイル追加・削除の動作確認

---

### 2. SCOPE_PROGRESS.mdの更新（優先度: 中）

**概要**:
P-002の状態を「未実装」から「完成（モック）」に更新する

---

### 3. Phase 4完了確認

**概要**:
全ページ（P-001a/b/c, P-002, P-003, P-004, P-005）のモック実装が完了したことを確認し、Phase 5（環境構築）に進む準備をする

---

## 取引先判別ルール（命名規則）

### ネクストビッツ様
| 判別キーワード | `TRR-` で始まる |
|---------------|----------------|

| 種別 | パターン | 例 |
|------|---------|-----|
| 見積書 | `TRR-YY-MMM_お見積書.pdf` | TRR-25-011_お見積書.pdf |
| 請求書 | `TRR-YY-MMM_請求書.pdf` | TRR-25-011_請求書.pdf |
| 注文請書 | `TRR-YY-MMM_注文請書.pdf` | TRR-25-011_注文請書.pdf |
| 納品書 | `TRR-YY-MMM_納品書.pdf` | TRR-25-011_納品書.pdf |

※ YY=年2桁、MMM=月3桁ゼロ埋め（例: 011=11月）

### オフビートワークス様
| 判別キーワード | `offbeat-to-terra` を含む |
|---------------|--------------------------|

| 種別 | パターン | 例 |
|------|---------|-----|
| 見積書 | `1NNNNNN見積-offbeat-to-terra-YYYYMM.pdf` | 1951030見積-offbeat-to-terra-202511.pdf |
| 請求書 | `2NNNNNN-請求_offbeat-to-terra-YYYYMM.pdf` | 2951030-請求_offbeat-to-terra-202511.pdf |
| 納品書 | `3NNNNNN-納品-offbeat-to-terra-YYYYMM.pdf` | 3951030-納品-offbeat-to-terra-202511.pdf |
| 注文請書 | `請書-offbeat-to-terra-YYYYMM.pdf` | 請書-offbeat-to-terra-202511.pdf |

※ NNNNNN=書類番号6桁（連番ではない）、YYYYMM=年月

---

## 関連ファイル

| ファイル | 用途 |
|----------|------|
| `frontend/src/pages/process/ProcessPage.tsx` | P-002ページ本体 |
| `frontend/src/services/mock/processService.ts` | PDF処理モックサービス |
| `docs/requirements.md` | 要件定義書（v1.8） |

---

## 開発サーバー起動コマンド

```bash
cd /home/iwafune-hiroko/seikyu-henkan-2/frontend && npm run dev
```

開発サーバー: http://localhost:5174/（または5175）
